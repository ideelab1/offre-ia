<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offre de Service - IdéeLab inc.</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #111827; --glass-bg: rgba(255, 255, 255, 0.05); --border-color: rgba(255, 255, 255, 0.1);
            --primary-color: #38bdf8; --secondary-color: #818cf8; --highlight-color: #f472b6;
            --text-color: #e5e7eb; --text-strong-color: #ffffff;
        }
        *, *::before, *::after { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; line-height: 1.7; background-color: var(--bg-color); color: var(--text-color); margin: 0; overflow: hidden; }
        .scroll-container { height: 100vh; overflow-y: scroll; scroll-snap-type: y mandatory; }
        .full-page { height: 100vh; scroll-snap-align: start; display: flex; justify-content: center; align-items: center; position: relative; padding: 2rem; }
        .container-interactive { width: 100%; max-width: 1000px; text-align: center; position: relative; z-index: 2; }
        .background-gradient { position: absolute; top: 50%; left: 50%; width: 800px; height: 800px; background: radial-gradient(circle, var(--primary-color), transparent 60%); filter: blur(150px); transform: translate(-50%, -50%); animation: rotate-gradient 20s infinite linear; opacity: 0.2; z-index: -1; }
        @keyframes rotate-gradient { from { transform: translate(-50%, -50%) rotate(0deg); } to { transform: translate(-50%, -50%) rotate(360deg); } }
        .top-right-controls { position: absolute; top: 20px; right: 20px; z-index: 10; display: flex; gap: 15px; }
        .control-btn { background: none; border: 1px solid var(--border-color); color: var(--text-color); padding: 8px 12px; border-radius: 8px; cursor: pointer; font-family: 'Inter', sans-serif; font-size: 14px; transition: background-color 0.3s, color 0.3s; display: flex; align-items: center; gap: 8px; }
        .control-btn:hover { background-color: var(--glass-bg); color: var(--text-strong-color); }
        .control-btn svg { width: 16px; height: 16px; fill: currentColor; }
        .hero-name { font-family: 'Lexend', sans-serif; font-size: clamp(3rem, 10vw, 5.5rem); color: var(--text-strong-color); margin: 0; }
        .hero-title { font-family: 'Lexend', sans-serif; font-size: clamp(1.2rem, 4vw, 1.8rem); margin: 0.5rem 0 1.5rem 0; font-weight: 400; color: var(--primary-color); }
        .section-title { font-family: 'Lexend', sans-serif; font-size: 2.5rem; color: var(--text-strong-color); margin-bottom: 2rem; }
        .cost-card { background: var(--glass-bg); backdrop-filter: blur(10px); padding: 2rem; border-radius: 15px; border: 1px solid var(--border-color); text-align: left; display: flex; flex-direction: column; }
        .cost-card-icon { margin-bottom: 1rem; color: var(--secondary-color); }
        .cost-card-icon svg { width: 40px; height: 40px; }
        .cost-card h4 { font-family: 'Lexend', sans-serif; color: var(--primary-color); font-size: 1.2rem; margin-top: 0; margin-bottom: 0.5rem; }
        .cost-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; }
        .roi-calculator { background: var(--glass-bg); backdrop-filter: blur(10px); padding: 2.5rem; border-radius: 15px; border: 1px solid var(--border-color); width: 100%; max-width: 800px; display: grid; grid-template-columns: 1fr 1fr; gap: 2.5rem; align-items: center; }
        .roi-controls { text-align: left; }
        .roi-result { text-align: center; }
        .slider-group { margin-bottom: 1.5rem; }
        .slider-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .slider-group input[type="range"] { width: 100%; }
        .slider-group .value { color: var(--primary-color); font-weight: 700; }
        .roi-result .label { font-size: 1.2rem; }
        .roi-result .amount { font-family: 'Lexend', sans-serif; font-size: clamp(2.5rem, 8vw, 4.5rem); color: var(--highlight-color); font-weight: 700; margin: 0.5rem 0; }
        .roi-result .per-year { font-size: 1rem; color: var(--text-color); }
        .project-section-layout { display: flex; align-items: center; gap: 3rem; width: 100%; max-width: 1100px; }
        .form-info { flex: 1; text-align: left; }
        .form-info p { color: var(--text-color); }
        .project-form { background: var(--glass-bg); backdrop-filter: blur(10px); padding: 2.5rem; border-radius: 15px; border: 1px solid var(--border-color); width: 100%; max-width: 500px; text-align: left; flex-shrink: 0; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        .full-width { grid-column: 1 / -1; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--primary-color); }
        .form-group input, .form-group textarea { width: 100%; padding: 0.8rem 1rem; border: 1px solid var(--border-color); background-color: #1A1A1A; color: var(--text-color); border-radius: 8px; font-family: 'Inter', sans-serif; font-size: 1rem; transition: border-color 0.3s ease; }
        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: var(--primary-color); }
        .form-group textarea { min-height: 120px; resize: vertical; }
        .print-btn { background-image: linear-gradient(to right, var(--primary-color), var(--secondary-color)); color: white; border: none; padding: 1rem 2.5rem; font-family: 'Lexend', sans-serif; font-size: 1.1rem; font-weight: 600; border-radius: 50px; cursor: pointer; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 10px 30px rgba(56, 189, 248, 0.2); }
        .print-btn:hover { transform: translateY(-5px) scale(1.05); box-shadow: 0 15px 40px rgba(56, 189, 248, 0.3); }
        .print-btn:disabled { opacity: 0.5; cursor: wait; }
        #particle-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        .printable-contract { display: none; }

        @media print {
            .scroll-container { display: none; }
            .printable-contract { display: block; }
            body { background-color: #fff !important; font-size: 10pt; padding: 0 !important; margin: 0 !important; overflow: visible; font-family: 'Inter', sans-serif; color: #272727; }
            .contract-container { width: 100%; height: 100%; display: flex; flex-direction: column; }
            .pdf-header { display: flex; justify-content: space-between; align-items: flex-start; border-bottom: 2px solid #38bdf8; padding-bottom: 1rem; margin-bottom: 1.5rem; }
            .pdf-header .logo { font-family: 'Lexend', sans-serif; font-size: 24pt; font-weight: 700; color: #111827; }
            .pdf-header .title { text-align: right; }
            .pdf-header .title h1 { font-family: 'Lexend', sans-serif; font-size: 20pt; margin: 0; color: #111827; }
            .pdf-header .title p { margin: 0; font-size: 10pt; color: #6c757d; }
            .pdf-footer { text-align: center; font-size: 8pt; color: #6c757d; border-top: 1px solid #e5e7eb; padding-top: 0.5rem; margin-top: auto; }
            .pdf-main { width: 100%; }
            .pdf-section { margin-bottom: 1.2rem; page-break-inside: avoid; }
            .pdf-section h2 { font-family: 'Lexend', sans-serif; font-size: 13pt; color: #38bdf8; margin-top: 0; margin-bottom: 0.75rem; border-bottom: 1px solid #e5e7eb; padding-bottom: 0.5rem; }
            
            .pdf-summary-band { display: flex; gap: 1rem; align-items: stretch; margin-bottom: 1.5rem; }
            .pdf-summary-band .pdf-section { flex: 1; margin-bottom: 0; border: 1px solid #e5e7eb; border-radius: 8px; padding: 0.75rem; background-color: #f8f9fa; }
            .pdf-summary-band .pdf-section h2 { font-size: 11pt; margin-bottom: 0.5rem; padding-bottom: 0.25rem; }
            .pdf-summary-band p, .pdf-summary-band .estimate-details { font-size: 9pt; }
            .pdf-summary-band .roi-section { background-color: #eefbff; border-color: #38bdf8; }
            .roi-summary p { font-size: 8pt; text-align: center; margin-bottom: 0.25rem; }
            .roi-amount { font-family: 'Lexend', sans-serif; font-size: 16pt; font-weight: 700; text-align: center; color: #1e3a8a; }
            .estimate-details .estimate-total { font-size: 14pt; margin-top: 0.5rem; text-align: center; font-weight: bold; color: #111827}
            blockquote { font-size: 10pt; padding: 0.5rem 1rem; border-left: 3px solid #38bdf8; margin-left: 0; font-style: italic; white-space: pre-wrap; background-color: #f8f9fa;}
            .disclaimer { font-size: 8pt; font-style: italic; color: #6c757d; margin-top: 1.5rem; border-top: 1px solid #e5e7eb; padding-top: 0.5rem; }
            
            .signature-section-container { background-color: transparent; padding: 0; margin-top: 2rem; }
            .signature-section-container h2 { display: none; }
            .signature-area { display: flex; justify-content: space-between; gap: 2rem; }
            .signature-block { flex: 1; text-align: center; }
            .signature-line { border-bottom: 1px solid #272727; height: 40px; margin-bottom: 0.5rem; }

            @page { size: letter; margin: 0.7in; }
        }
    </style>
</head>
<body>

    <div class="scroll-container">
        <div class="background-gradient"></div>
        <section class="hero full-page"><canvas id="particle-canvas"></canvas><div class="top-right-controls"><button id="lang-toggle" class="control-btn">EN</button><button id="fullscreen-toggle" class="control-btn"><svg viewBox="0 0 24 24"><path d="M5,5H10V7H7V10H5V5M14,5H19V10H17V7H14V5M17,14H19V19H14V17H17V14M10,17H7V19H5V14H7V17H10V19Z"></path></svg></button></div><div class="container-interactive"><h1 class="hero-name" data-lang="heroName">IdéeLab inc.</h1><h2 class="hero-title" data-lang="heroTitle">Explorer l'innovation, créer le futur.</h2></div></section>
        <section class="full-page"><div class="container-interactive"><h3 class="section-title" data-lang="approachTitle">Notre Approche</h3><p data-lang="approachText" style="max-width: 700px; margin: 0 auto;">Nous transformons vos défis en opportunités. Notre processus de co-création garantit que chaque solution d'IA ou d'automatisation est parfaitement alignée avec votre réalité et vos ambitions.</p></div></section>
        <section class="full-page"><div class="container-interactive"><h3 class="section-title" data-lang="costTitle">Le Coût de l'Inertie</h3><div class="cost-grid"><div class="cost-card"><div class="cost-card-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg></div><h4 data-lang="costCard1Title">Tâches Répétitives</h4><p data-lang="costCard1Text">Des heures précieuses sont perdues chaque semaine par vos équipes sur des tâches manuelles qui pourraient être automatisées.</p></div><div class="cost-card"><div class="cost-card-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg></div><h4 data-lang="costCard2Title">Erreurs Humaines</h4><p data-lang="costCard2Text">La saisie manuelle de données et les processus complexes entraînent des erreurs coûteuses en temps et en argent.</p></div><div class="cost-card"><div class="cost-card-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.5 22a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-2zM18 19H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v3"/><path d="M12 5V2a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v3"/><path d="M3 10h18"/><path d="m19 14-4 4-2-2"/></svg></div><h4 data-lang="costCard3Title">Potentiel Inexploité</h4><p data-lang="costCard3Text">Vos employés les plus qualifiés sont freinés par des tâches administratives, au lieu de se concentrer sur la croissance et l'innovation.</p></div></div></div></section>
        <section class="full-page"><div class="container-interactive"><h3 class="section-title" data-lang="roiTitle">Calculez Votre Potentiel</h3><div class="roi-calculator"><div class="roi-controls"><div class="slider-group"><label for="employees" data-lang="roiEmployees">Nombre d'employés effectuant ces tâches</label><input type="range" id="employees" min="1" max="50" value="5" oninput="updateROI()"><span class="value"><span id="employeesValue">5</span></span></div><div class="slider-group"><label for="hours" data-lang="roiHours">Heures perdues par employé par semaine</label><input type="range" id="hours" min="1" max="10" value="3" oninput="updateROI()"><span class="value"><span id="hoursValue">3</span>h</span></div><div class="slider-group"><label for="wage" data-lang="roiWage">Coût horaire moyen d'un employé</label><input type="range" id="wage" min="20" max="100" value="35" step="5" oninput="updateROI()"><span class="value"><span id="wageValue">35</span> $/h</span></div></div><div class="roi-result"><div class="label" data-lang="roiSavings">Économies annuelles potentielles</div><div class="amount" id="roiAmount">$27,300</div><div class="per-year" data-lang="roiPerYear">par année</div></div></div></div></section>
        <section class="full-page"><div class="project-section-layout"><div class="form-info"><h3 class="section-title" data-lang="projectTitle" style="text-align: left;">Définissons Votre Projet</h3><p data-lang="projectDesc">Pour nous permettre de cerner vos besoins, veuillez remplir ce court formulaire. Les informations fournies nous aideront à générer une ébauche de solution personnalisée dans votre offre de service.</p></div><div class="project-form"><div class="form-grid"><div class="form-group"><label for="companyName" data-lang="formCompany">Nom de l'entreprise</label><input type="text" id="companyName" data-lang-placeholder="formCompanyPlaceholder"></div><div class="form-group"><label for="clientName" data-lang="formName">Personne ressource</label><input type="text" id="clientName" data-lang-placeholder="formNamePlaceholder"></div></div><div class="form-group full-width"><label for="clientContact" data-lang="formContact">Coordonnées (courriel ou téléphone)</label><input type="text" id="clientContact" data-lang-placeholder="formContactPlaceholder"></div><div class="form-group full-width"><label for="projectGoals" data-lang="formGoals">Description du projet et objectifs</label><textarea id="projectGoals" data-lang-placeholder="formGoalsPlaceholder"></textarea></div></div></div></section>
        <section class="full-page contact"><div class="container-interactive"><h3 class="section-title" data-lang="ctaTitle">Prêts à lancer le projet ?</h3><button id="generateBtn" class="print-btn" onclick="prepareAndPrint()" data-lang="ctaButton">Générer l'Offre de Service</button></div></section>
    </div>
    
    <div class="printable-contract">
        <div class="contract-container">
            <header class="pdf-header"><div class="logo">IdéeLab</div><div class="title"><h1 data-lang-print="contractTitle"></h1><p data-lang-print="contractPresentedBy"></p></div></header>
            <main class="pdf-main">
                <div class="pdf-summary-band">
                    <section class="pdf-section"><h2 data-lang-print="contractClient"></h2><p><strong id="contractCompanyName"></strong><br><span data-lang-print="contractAttention"></span> <span id="contractClientName"></span><br><span id="contractClientContact"></span></p></section>
                    <section class="pdf-section roi-section"><h2 data-lang-print="contractRoiTitle"></h2><div class="roi-summary"><p data-lang-print="contractRoiText"></p><div class="roi-amount" id="contractRoiValue"></div></div></section>
                    <section class="pdf-section"><h2 data-lang-print="contractInvestment"></h2><div class="estimate-details"><p><span id="contractEstimatedHours"></span>h @ 75.00 $</p><p class="estimate-total"><span id="contractTotalEstimate"></span></p></div></section>
                </div>
                <section class="pdf-section"><h2 data-lang-print="contractUnderstanding"></h2><blockquote id="contractProjectGoals"></blockquote></section>
                <section class="pdf-section"><h2 data-lang-print="contractSolution"></h2><div id="contractSolution"></div></section>
                <p class="disclaimer" data-lang-print="contractDisclaimer"></p>
                <section class="pdf-section signature-section-container"><h2 data-lang-print="contractSignature"></h2><div class="signature-area"><div class="signature-block"><div class="signature-line"></div><p><strong>IdéeLab inc.</strong><br><span data-lang-print="signatureDate"></span></p></div><div class="signature-block"><div class="signature-line"></div><p><strong id="contractSignatureName"></strong><br><span data-lang-print="signatureDate"></span></p></div></div></section>
            </main>
            <footer class="pdf-footer">IdéeLab inc. | 123 Rue de l'Innovation, Montréal, QC | contact@ideelab.dev</footer>
        </div>
    </div>

    <script>
        const translations = {
            fr: {
                heroName: "IdéeLab inc.", heroTitle: "Explorer l'innovation, créer le futur.",
                approachTitle: "Notre Approche", approachText: "Nous transformons vos défis en opportunités. Notre processus de co-création garantit que chaque solution d'IA ou d'automatisation est parfaitement alignée avec votre réalité et vos ambitions.",
                costTitle: "Le Coût de l'Inertie", costCard1Title: "Tâches Répétitives", costCard1Text: "Des heures précieuses sont perdues chaque semaine par vos équipes sur des tâches manuelles qui pourraient être automatisées.", costCard2Title: "Erreurs Humaines", costCard2Text: "La saisie manuelle de données et les processus complexes entraînent des erreurs coûteuses en temps et en argent.", costCard3Title: "Potentiel Inexploité", costCard3Text: "Vos employés les plus qualifiés sont freinés par des tâches administratives, au lieu de se concentrer sur la croissance et l'innovation.",
                roiTitle: "Calculez Votre Potentiel", roiEmployees: "Nombre d'employés effectuant ces tâches", roiHours: "Heures perdues par employé par semaine", roiWage: "Coût horaire moyen d'un employé", roiSavings: "Économies annuelles potentielles", roiPerYear: "par année",
                projectTitle: "Définissons Votre Projet", projectDesc: "Pour nous permettre de cerner vos besoins, veuillez remplir ce court formulaire. Les informations fournies nous aideront à générer une ébauche de solution personnalisée dans votre offre de service.",
                formCompany: "Nom de l'entreprise", formCompanyPlaceholder: "Ex: Ma Compagnie Inc.",
                formName: "Personne ressource", formNamePlaceholder: "Ex: Jean Dupont",
                formContact: "Coordonnées (courriel ou téléphone)", formContactPlaceholder: "Ex: jean.dupont@macompagnie.com",
                formGoals: "Description du projet et objectifs", formGoalsPlaceholder: "Ex: Nous souhaitons automatiser notre service client...",
                ctaTitle: "Prêts à lancer le projet ?", ctaButton: "Générer l'Offre de Service",
                contractTitle: "Offre de Service", contractPresentedBy: "Présentée par IdéeLab inc.",
                contractClient: "Client", contractAttention: "À l'attention de:",
                contractUnderstanding: "Compréhension du Projet", contractSolution: "Solution Proposée", contractSolutionText: "IdéeLab inc. propose de développer une solution sur mesure pour répondre aux objectifs cités ci-dessus.",
                contractInvestment: "Investissement", estimatedHours: "Heures estimées", hourlyRate: "Taux horaire", estimatedTotal: "Total",
                contractDisclaimer: "Veuillez noter que cette estimation est fournie à titre indicatif, basée sur notre compréhension initiale de vos besoins. Le coût final sera facturé en fonction des heures réelles consacrées au projet.",
                contractSignature: "Signatures", signatureDate: "Date",
                contractRoiTitle: "ROI Potentiel", contractRoiText: "Basé sur les données fournies, l'automatisation de ces processus pourrait représenter une économie annuelle estimée de :",
            },
            en: {
                heroName: "IdéeLab Inc.", heroTitle: "Explore innovation, create the future.",
                approachTitle: "Our Approach", approachText: "We transform your challenges into opportunities. Our co-creation process ensures that each AI and automation solution is perfectly aligned with your reality and ambitions.",
                costTitle: "The Cost of Inaction", costCard1Title: "Repetitive Tasks", costCard1Text: "Valuable hours are lost each week by your teams on manual tasks that could be automated.", costCard2Title: "Human Errors", costCard2Text: "Manual data entry and complex processes lead to costly errors in time and money.", costCard3Title: "Untapped Potential", costCard3Text: "Your most skilled employees are held back by administrative tasks, instead of focusing on growth and innovation.",
                roiTitle: "Calculate Your Potential", roiEmployees: "Number of employees performing these tasks", roiHours: "Hours lost per employee per week", roiWage: "Average hourly cost of an employee", roiSavings: "Potential Annual Savings", roiPerYear: "per year",
                projectTitle: "Let's Define Your Project", projectDesc: "To help us understand your needs, please fill out this short form. The information provided will help us generate a personalized draft solution in your service offer.",
                formCompany: "Company Name", formCompanyPlaceholder: "Ex: My Company Inc.",
                formName: "Contact Person", formNamePlaceholder: "Ex: Jane Doe",
                formContact: "Contact Information (email or phone)", formContactPlaceholder: "Ex: jane.doe@mycompany.com",
                formGoals: "Project description and objectives", formGoalsPlaceholder: "Ex: We want to automate our first-level customer service with an AI agent...",
                ctaTitle: "Ready to launch the project?", ctaButton: "Generate Service Offer",
                contractTitle: "Service Offer", contractPresentedBy: "Presented by IdéeLab Inc.",
                contractClient: "Client", contractAttention: "Attention:",
                contractUnderstanding: "Project Understanding", contractSolution: "Proposed Solution", contractSolutionText: "IdéeLab Inc. proposes to develop a custom solution to meet the objectives mentioned above.",
                contractInvestment: "Investment", estimatedHours: "Estimated Hours", hourlyRate: "Hourly Rate", estimatedTotal: "Total",
                contractDisclaimer: "Please note that this is an indicative estimate based on our initial understanding of your needs. The final cost will be billed based on the actual hours dedicated to the project.",
                contractSignature: "Signatures", signatureDate: "Date",
                contractRoiTitle: "Potential ROI", contractRoiText: "Based on the provided data, automating these processes could represent an estimated annual saving of:",
            }
        };

        let currentLang = 'fr';

        function switchLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            document.querySelectorAll('[data-lang]').forEach(el => {
                const key = el.getAttribute('data-lang');
                if (translations[lang][key]) { el.innerHTML = translations[lang][key]; }
            });
            document.querySelectorAll('[data-lang-placeholder]').forEach(el => {
                const key = el.getAttribute('data-lang-placeholder');
                if (translations[lang][key]) { el.placeholder = translations[lang][key]; }
            });
            document.getElementById('lang-toggle').textContent = lang === 'fr' ? 'EN' : 'FR';
            updateROI();
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) { document.documentElement.requestFullscreen().catch(err => console.error(err)); } 
            else { if (document.exitFullscreen) { document.exitFullscreen().catch(err => console.error(err)); } }
        }
        
        function updateROI() {
            const employees = document.getElementById('employees').value;
            const hours = document.getElementById('hours').value;
            const wage = document.getElementById('wage').value;
            document.getElementById('employeesValue').textContent = employees;
            document.getElementById('hoursValue').textContent = hours;
            document.getElementById('wageValue').textContent = wage;
            const annualSavings = (employees * hours * wage) * 52;
            const formatter = new Intl.NumberFormat(currentLang === 'fr' ? 'fr-CA' : 'en-CA', { style: 'currency', currency: 'CAD', minimumFractionDigits: 0, maximumFractionDigits: 0 });
            document.getElementById('roiAmount').textContent = formatter.format(annualSavings);
        }

        function estimateProjectHours(projectGoals) {
            const goals = projectGoals.toLowerCase(); let hours = 20;
            const keywords = {
                customer_service: ['service client', 'support', 'clientèle', 'questions', 'customer service'],
                invoicing: ['facture', 'facturation', 'paiement', 'comptabilité', 'invoice', 'billing', 'payment'],
                data_analysis: ['données', 'rapport', 'analyse', 'reporting', 'data', 'analysis'],
                process_automation: ['processus', 'tâches', 'répétitif', 'automatiser', 'process', 'tasks', 'automate']
            };
            if (keywords.customer_service.some(kw => goals.includes(kw))) hours += 25;
            if (keywords.invoicing.some(kw => goals.includes(kw))) hours += 30;
            if (keywords.data_analysis.some(kw => goals.includes(kw))) hours += 40;
            if (keywords.process_automation.some(kw => goals.includes(kw))) hours += 20;
            if (goals.length > 200) hours += 15; if (goals.length > 400) hours += 20;
            return hours;
        }

        async function generateSolutionWithAI(projectGoals, lang) {
            try {
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ projectGoals, lang }),
                });

                if (!response.ok) {
                    throw new Error(`Erreur de l'API: ${response.statusText}`);
                }

                const data = await response.json();
                return data.solution;

            } catch (error) {
                console.error("Impossible de contacter notre API.", error);
                return `<p>${translations[lang].contractSolutionText}</p>`;
            }
        }
        
        let animationFrameId; let isAnimationRunning = true;

        async function prepareAndPrint() {
            const generateBtn = document.getElementById('generateBtn');
            generateBtn.disabled = true;
            generateBtn.innerHTML = currentLang === 'fr' ? 'Génération par IA...' : 'Generating with AI...';
            isAnimationRunning = false;
            if (animationFrameId) { cancelAnimationFrame(animationFrameId); }

            try {
                document.querySelectorAll('[data-lang-print]').forEach(el => {
                    const key = el.getAttribute('data-lang-print');
                    if (translations[currentLang][key]) { el.innerHTML = translations[currentLang][key]; }
                });

                const clientName = document.getElementById('clientName').value;
                const companyName = document.getElementById('companyName').value;
                const clientContact = document.getElementById('clientContact').value;
                const projectGoals = document.getElementById('projectGoals').value;
                const potentialSavings = document.getElementById('roiAmount').textContent;
                
                const solutionHtml = await generateSolutionWithAI(projectGoals, currentLang); 
                document.getElementById('contractSolution').innerHTML = solutionHtml;
                
                const estimatedHours = estimateProjectHours(projectGoals);
                const totalCost = estimatedHours * 75;

                document.getElementById('contractClientName').textContent = clientName || (currentLang === 'fr' ? "[Non spécifié]" : "[Not specified]");
                document.getElementById('contractCompanyName').textContent = companyName || (currentLang === 'fr' ? "[Non spécifié]" : "[Not specified]");
                document.getElementById('contractClientContact').textContent = clientContact || (currentLang === 'fr' ? "[Non spécifié]" : "[Not specified]");
                document.getElementById('contractProjectGoals').textContent = projectGoals || (currentLang === 'fr' ? "[Objectifs non spécifiés]" : "[Objectives not specified]");
                document.getElementById('contractRoiValue').textContent = potentialSavings;
                document.getElementById('contractSignatureName').textContent = companyName || (currentLang === 'fr' ? "[Nom de l'Entreprise]" : "[Company Name]");
                
                document.getElementById('contractEstimatedHours').textContent = estimatedHours;
                document.getElementById('contractTotalEstimate').textContent = `${totalCost.toLocaleString(currentLang === 'fr' ? 'fr-CA' : 'en-CA', { style: 'currency', currency: 'CAD' })}`;

                setTimeout(() => { window.print(); }, 100);

            } catch (error) {
                console.error("Erreur lors de la préparation de l'impression:", error);
                alert(currentLang === 'fr' ? "Une erreur est survenue. Veuillez réessayer." : "An error occurred. Please try again.");
                generateBtn.disabled = false;
                generateBtn.innerHTML = translations[currentLang].ctaButton; // Use innerHTML to be consistent
                isAnimationRunning = true;
                if(typeof animate === "function") animate();
            }
        }
        
        window.addEventListener('load', () => {
            switchLanguage('fr');
            updateROI();
            document.getElementById('lang-toggle').addEventListener('click', () => switchLanguage(currentLang === 'fr' ? 'en' : 'fr'));
            document.getElementById('fullscreen-toggle').addEventListener('click', toggleFullscreen);

            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            let particlesArray;

            const resizeCanvas = () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; init(); };
            class Particle {
                constructor(x, y, dX, dY, size) { this.x = x; this.y = y; this.directionX = dX; this.directionY = dY; this.size = size; }
                draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fillStyle = 'rgba(163, 163, 163, 0.5)'; ctx.fill(); }
                update() {
                    if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
                    if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
                    this.x += this.directionX; this.y += this.directionY; this.draw();
                }
            }
            function init() {
                particlesArray = [];
                let numParticles = (canvas.height * canvas.width) / 9000;
                for (let i = 0; i < numParticles; i++) {
                    let size = (Math.random() * 2) + 1;
                    let x = Math.random() * (innerWidth - size * 2) + size;
                    let y = Math.random() * (innerHeight - size * 2) + size;
                    let dX = (Math.random() * .4) - .2;
                    let dY = (Math.random() * .4) - .2;
                    particlesArray.push(new Particle(x, y, dX, dY, size));
                }
            }
            function connect() {
                for (let a = 0; a < particlesArray.length; a++) {
                    for (let b = a; b < particlesArray.length; b++) {
                        let dist = Math.hypot(particlesArray[a].x - particlesArray[b].x, particlesArray[a].y - particlesArray[b].y);
                        if (dist < (canvas.width / 7)) {
                            let opacity = 1 - (dist / 150);
                            ctx.strokeStyle = `rgba(129, 140, 248, ${opacity})`;
                            ctx.lineWidth = 1;
                            ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                        }
                    }
                }
            }
            function animate() {
                if (!isAnimationRunning) return;
                animationFrameId = requestAnimationFrame(animate);
                ctx.clearRect(0, 0, innerWidth, innerHeight);
                particlesArray.forEach(p => p.update());
                connect();
            }
            window.addEventListener('resize', resizeCanvas);
            window.addEventListener('afterprint', () => {
                const generateBtn = document.getElementById('generateBtn');
                generateBtn.disabled = false;
                generateBtn.innerHTML = translations[currentLang].ctaButton;
                isAnimationRunning = true;
                animate();
            });
            resizeCanvas();
            animate();
        });
    </script>

</body>
</html>